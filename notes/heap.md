# p.5 Operations and Time Complexity

---

## 0ï¸âƒ£ å…±åŒå‰æ

### Heap ä¸€å®šè¦ç¶­æŒå…©ä»¶äº‹

1. **å®Œå…¨äºŒå…ƒæ¨¹ï¼ˆå½¢ç‹€ä¸èƒ½äº‚ï¼‰**
2. **Heap-orderï¼ˆçˆ¶ â‰¥ å­ æˆ– å­ â‰¥ çˆ¶ï¼‰**

ğŸ‘‰ æ‰€æœ‰æ“ä½œçš„ç›®çš„åªæœ‰ä¸€å€‹ï¼š
**ã€Œåšå®Œäº‹æƒ…å¾Œï¼ŒæŠŠé€™å…©ä»¶äº‹ä¿®å¥½ã€**

## 1ï¸âƒ£ `insert(x)` â€” æ’å…¥æ–°å…ƒç´ 

## æ¯æ¬¡æ–°å¢æˆ–åˆªé™¤ç¯€é»å¾Œï¼ŒHeap æœƒè‡ªå‹•ã€Œä¸Šæµ®ï¼ˆbubble upï¼‰ã€æˆ–ã€Œä¸‹æ²‰ï¼ˆbubble downï¼‰ã€ä¾†ä¿æŒé †åºæ€§ã€‚

## åšæ³•
> æŠŠæ–°è³‡æ–™ `x` æ”¾é€² Heapï¼Œ
> ç„¶å¾Œæƒ³è¾¦æ³•è®“ Heap ä¸å£æ‰ã€‚

## æ­£ç¢ºæ­¥é©Ÿ

### Step 1ï¼šæ”¾åœ¨ã€Œæœ€å¾Œä¸€å€‹ä½ç½®ã€

* ç‚ºäº†ä¿æŒ **å®Œå…¨äºŒå…ƒæ¨¹**
* åœ¨é™£åˆ—å°±æ˜¯ï¼š`push_back(x)`

âš ï¸ **ä¸èƒ½äº‚æ”¾**

### Step 2ï¼šæª¢æŸ¥ Heap-order

**1.Max heap:**   
* å’Œ **parent æ¯”**
* å¦‚æœ `x > parent`
  â†’ äº¤æ›
* ä¸€ç›´å¾€ä¸Šæ¯”ï¼Œç›´åˆ°ï¼š

  * x <= parent
  * æˆ–åˆ° root

**1.Min heap:**   
* å’Œ **parent æ¯”**
* å¦‚æœ `x < parent`
  â†’ äº¤æ›
* ä¸€ç›´å¾€ä¸Šæ¯”ï¼Œç›´åˆ°ï¼š

  * x >= parent
  * æˆ–åˆ° root

é€™å€‹å‹•ä½œå«ï¼š
ğŸ‘‰ **sift-upï¼ˆä¸Šæµ®ï¼‰**

## ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* Heap é«˜åº¦ = log n
* æœ€å¤šåªæœƒä¸€è·¯æ›åˆ° root

## ä¸€å¥è©±è¨˜æ†¶æ³•ï¼ˆè€ƒè©¦ï¼‰

> **Insert = æ”¾æœ€å¾Œ â†’ ä¸€è·¯å¾€ä¸Šæ›**

---

## 2ï¸âƒ£ `extract_root()` â€” ç§»é™¤æœ€å¤§å€¼ï¼ˆæˆ–æœ€å°å€¼ï¼‰

## æ¯æ¬¡æ–°å¢æˆ–åˆªé™¤ç¯€é»å¾Œï¼ŒHeap æœƒè‡ªå‹•ã€Œä¸Šæµ®ï¼ˆbubble upï¼‰ã€æˆ–ã€Œä¸‹æ²‰ï¼ˆbubble downï¼‰ã€ä¾†ä¿æŒé †åºæ€§ã€‚

## åšæ³•

> æŠŠ Heap è£¡ã€Œæœ€é‡è¦çš„ã€å…ƒç´ æ‹¿èµ°
> ï¼ˆMax Heap = æœ€å¤§å€¼ï¼‰
> ï¼ˆMin Heap = æœ€å°å€¼ï¼‰ 

## ç‚ºä»€éº¼ä¸èƒ½ç›´æ¥åˆª rootï¼Ÿ

âŒ ç›´æ¥åˆª â†’ å½¢ç‹€å£æ‰
âŒ é™£åˆ—æœƒæœ‰æ´

## æ­£ç¢ºæ­¥é©Ÿ

### Step 1ï¼šæ‹¿èµ° rootï¼ˆå…ˆè¨˜èµ·ä¾†ï¼‰

* é€™å°±æ˜¯ä½ è¦å›å‚³çš„ç­”æ¡ˆ

### Step 2ï¼šç”¨ã€Œæœ€å¾Œä¸€å€‹ç¯€é»ã€è£œ root

* ä¿æŒå®Œå…¨äºŒå…ƒæ¨¹
* é™£åˆ—ï¼šæŠŠæœ€å¾Œä¸€å€‹ä¸Ÿåˆ° index 0

### Step 3ï¼šä¿® Heap-orderï¼ˆsift-downï¼‰

**1.Max heap:**
* root å¯èƒ½å¤ªå°
* è·Ÿ **è¼ƒå¤§çš„å­ç¯€é»** æ¯”
* å¦‚æœå­ç¯€é»æ¯”è¼ƒå¤§ â†’ äº¤æ›
* ä¸€è·¯å¾€ä¸‹

**2.Min heap:**
* root å¯èƒ½å¤ªå¤§
* è·Ÿ **è¼ƒå°çš„å­ç¯€é»** æ¯”
* å¦‚æœå­ç¯€é»æ¯”è¼ƒå° â†’ äº¤æ›
* ä¸€è·¯å¾€ä¸‹

é€™å€‹å‹•ä½œå«ï¼š
ğŸ‘‰ **sift-downï¼ˆä¸‹æ²‰ï¼‰**

## ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* åªæœƒæ²¿è‘—æ¨¹å¾€ä¸‹èµ°ä¸€æ¢è·¯
* é«˜åº¦ = log n

## ä¸€å¥è©±è¨˜æ†¶æ³•

> **Extract = æœ€å¾Œè£œä¸Š â†’ ä¸€è·¯å¾€ä¸‹æ›**

---

## 3ï¸âƒ£ `peek_root()` â€” çœ‹æœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼ˆä¸åˆªï¼‰

## åšæ³•

> çœ‹ä¸€ä¸‹ç›®å‰æœ€é‡è¦çš„æ˜¯èª°ï¼Œä¸åˆªæ‰

## æ€éº¼åšï¼Ÿ

* ç›´æ¥å›å‚³ `heap[0]`

## ç‚ºä»€éº¼æ˜¯ O(1)ï¼Ÿ

* ä¸ç”¨æ¯”è¼ƒ
* ä¸ç”¨äº¤æ›
* root æ°¸é åœ¨å›ºå®šä½ç½®

## ä¸€å¥è©±è¨˜æ†¶æ³•

> **Peek = çœ‹ rootï¼Œä¸å‹•å®ƒ**

---

## 4ï¸âƒ£ `heapify(i)` â€” ä¿®å¥½æŸä¸€å€‹ç¯€é»çš„ Heap æ€§è³ª

## åšæ³•

> å‡è¨­ï¼š
>
> * ä»¥ `i` ç‚º root çš„å·¦å³å­æ¨¹ **å·²ç¶“æ˜¯ Heap**
> * ä½† `i` è‡ªå·±å¯èƒ½å£æ‰
>
> ğŸ‘‰ å¹« `i` æŠŠ Heap-order ä¿®å¥½

## ä»€éº¼æ™‚å€™æœƒç”¨ï¼Ÿ

* `extract_root()` è£¡é¢ä¸€å®šç”¨
* `build_heap()` æœƒå¤§é‡ç”¨

## æ­£ç¢ºåšæ³•

**1.Max Heap:**   
1. æ‰¾ `i`ã€leftã€right
2. æ‰¾ **ä¸‰å€‹ä¸­æœ€å¤§çš„**
3. å¦‚æœæœ€å¤§ä¸æ˜¯ `i`

   * äº¤æ›
   * å°äº¤æ›å¾Œçš„ä½ç½® **ç¹¼çºŒ heapify**

ğŸ‘‰ æœ¬è³ªï¼šå¾€ä¸‹æ¯”å¤§çš„ï¼ˆsift-downï¼‰

**2.Min Heap:**   
1. æ‰¾ `i`ã€leftã€right
2. æ‰¾ **ä¸‰å€‹ä¸­æœ€å°çš„**
3. å¦‚æœæœ€å°ä¸æ˜¯ `i`

   * äº¤æ›
   * å°äº¤æ›å¾Œçš„ä½ç½® **ç¹¼çºŒ heapify**

ğŸ‘‰ æœ¬è³ªï¼šå¾€ä¸‹æ¯”å°çš„ï¼ˆsift-downï¼‰

## ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* æœ€å¤šä¸€è·¯å¾€ä¸‹
* ä¸æœƒè¶…éæ¨¹é«˜

## ä¸€å¥è©±è¨˜æ†¶æ³•

> **heapify = å¾ä¸Šå¾€ä¸‹ä¿®é †åº**

---

## 5ï¸âƒ£ `build_heap(array)` â€” æŠŠä¸€å€‹ç„¡åºé™£åˆ— array è®Šæˆ Heap

ğŸ”¥ **æ„›è€ƒé™·é˜±**

## åšæ³•

> çµ¦ä½ ä¸€å€‹ã€Œäº‚ä¸ƒå…«ç³Ÿçš„é™£åˆ—ã€ï¼Œ
> æŠŠå®ƒè®Šæˆä¸€å€‹åˆæ³•çš„ Heapã€‚

## âŒ éŒ¯èª¤ç›´è¦ºï¼ˆæ…¢ï¼‰

```
ä¸€å€‹ä¸€å€‹ insert
â†’ O(n log n)
```

## âœ… æ­£ç¢ºåšæ³•ï¼ˆå¿«ï¼‰

### é—œéµè§€å¿µ

* **è‘‰ç¯€é»æœ¬ä¾†å°±ä¸æœƒå£ Heap**
* åªè¦å¾ã€Œæœ€å¾Œä¸€å€‹éè‘‰ç¯€é»ã€é–‹å§‹

### æ­£ç¢ºæ­¥é©Ÿ

1. æ‰¾æœ€å¾Œä¸€å€‹éè‘‰ç¯€é»
   `i = n/2 - 1`
2. å° i åš `heapify(i)`
3. i--ï¼Œä¸€ç›´åšåˆ° 0

```
ç‚ºä»€éº¼å¾ n/2 - 1ï¼Ÿ   
å› ç‚ºï¼š    
index â‰¥ n/2 çš„ç¯€é»ï¼Œä¸€å®šæ˜¯è‘‰ç¯€é»ï¼Œè‘‰ç¯€é»ä¸å¯èƒ½é•å heap-order   
ğŸ‘‰ æ‰€ä»¥ï¼š    
åªéœ€è¦è™•ç† 0 ~ n/2 - 1   
```

## ç‚ºä»€éº¼æ˜¯ O(n)ï¼Ÿï¼ˆé‡è¦ä½†ä¸ç”¨èƒŒæ¨å°ï¼‰

* åº•å±¤ç¯€é»å¾ˆå¤šï¼Œä½†å¹¾ä¹ä¸ç”¨å‹•
* è¶Šä¸Šé¢ç¯€é»å°‘ï¼Œä½†æ‰æœƒå‹•å¾ˆå¤š
* **ç¸½æˆæœ¬åŠ èµ·ä¾†æ˜¯ O(n)**

## ä¸€å¥è©±è¨˜æ†¶æ³•ï¼ˆè€ƒè©¦ï¼‰

> **Build Heap = å¾å¾Œå¾€å‰åš heapify**

# ğŸ“Œ æ•´ç†

| æ“ä½œ      | æ ¸å¿ƒå‹•ä½œ       | é—œéµè©       |
| ------- | ---------- | --------- |
| insert  | æ”¾æœ€å¾Œ â†’ ä¸Šæµ®   | sift-up   |
| extract | æœ€å¾Œè£œ â†’ ä¸‹æ²‰   | sift-down |
| peek    | çœ‹ root     | O(1)      |
| heapify | å¾ä¸Šå¾€ä¸‹ä¿®      | ä¸‹æ²‰        |
| build   | åå‘ heapify | O(n)      |

---

# p.5 Build Heap å¯¦éš›ä¾‹å­

## ä¸€ã€æˆ‘å€‘çš„æ¸¬è©¦é™£åˆ—

å‡è¨­è¼¸å…¥é™£åˆ—æ˜¯ï¼š

```
A = [4, 10, 3, 5, 1]
index: 0  1   2  3  4
```

é•·åº¦ `n = 5`

## é—œéµè¦å‰‡ï¼ˆä¸€å®šå…ˆè¨˜ï¼‰

* **æœ€å¾Œä¸€å€‹éè‘‰ç¯€é» index = n/2 âˆ’ 1**
* `n = 5`
  ğŸ‘‰ `n/2 âˆ’ 1 = 1`

ğŸ‘‰ æ‰€ä»¥æˆ‘å€‘æœƒå¾ **index = 1 â†’ 0** ä¾åºåš `heapify`

---

## äºŒã€build_heap â†’ Max Heapï¼ˆå®Œæ•´å¯¦ä½œï¼‰

## åˆå§‹ç‹€æ…‹ï¼ˆé‚„ä¸æ˜¯ Heapï¼‰

```
        4
       / \
     10   3
     / \
    5   1
```

## Step 1ï¼ši = 1ï¼Œheapify(1)

### çœ‹ç¯€é» 1

* parent = 10
* children = 5ã€1

### æ¯”å¤§å°ï¼ˆMax Heapï¼‰

* æœ€å¤§æ˜¯ **10**
* ä¸ç”¨äº¤æ›

âœ… é™£åˆ—ä¸è®Šï¼š

```
[4, 10, 3, 5, 1]
```

---

## Step 2ï¼ši = 0ï¼Œheapify(0)

### çœ‹ç¯€é» 0

* parent = 4
* children = 10ã€3

### æ‰¾æœ€å¤§

* æœ€å¤§æ˜¯ **10ï¼ˆindex 1ï¼‰**

âŒ Heap-order è¢«ç ´å£ â†’ äº¤æ›

### äº¤æ›å¾Œ

```
[10, 4, 3, 5, 1]
```

æ¨¹ç‹€åœ–ï¼š

```
        10
       /  \
      4    3
     / \
    5   1
```

---

### ç¹¼çºŒ heapifyï¼ˆå› ç‚ºäº¤æ›äº†ï¼‰

#### å° index = 1 å† heapify

* parent = 4
* children = 5ã€1
* æœ€å¤§æ˜¯ **5**

âŒ å†äº¤æ›

```
[10, 5, 3, 4, 1]
```

---

### index = 3 æ˜¯è‘‰ç¯€é» â†’ åœæ­¢

---

## âœ… Max Heap å»ºç«‹å®Œæˆ

### æœ€çµ‚çµæœ

```
[10, 5, 3, 4, 1]
```

æ¨¹ç‹€åœ–ï¼š

```
        10
       /  \
      5    3
     / \
    4   1
```

---

## ä¸‰ã€build_heap â†’ Min Heapï¼ˆåŒä¸€é™£åˆ—ï¼‰

ç¾åœ¨æˆ‘å€‘ **é‡æ–°ä¾†ä¸€æ¬¡**ï¼Œ
é‚„æ˜¯å¾åŸå§‹é™£åˆ—ï¼š

```
[4, 10, 3, 5, 1]
```

---

## Step 1ï¼ši = 1ï¼Œheapify(1)

### çœ‹ç¯€é» 1

* parent = 10
* children = 5ã€1

### æ‰¾æœ€å°ï¼ˆMin Heapï¼‰

* æœ€å°æ˜¯ **1ï¼ˆindex 4ï¼‰**

âŒ äº¤æ›

```
[4, 1, 3, 5, 10]
```

---

### index = 4 æ˜¯è‘‰ç¯€é» â†’ åœæ­¢

---

## Step 2ï¼ši = 0ï¼Œheapify(0)

### çœ‹ç¯€é» 0

* parent = 4
* children = 1ã€3

### æ‰¾æœ€å°

* æœ€å°æ˜¯ **1ï¼ˆindex 1ï¼‰**

âŒ äº¤æ›

```
[1, 4, 3, 5, 10]
```

---

### ç¹¼çºŒ heapifyï¼ˆindex = 1ï¼‰

* parent = 4
* children = 5ã€10
* æœ€å°æ˜¯ **4**

âœ… ä¸ç”¨äº¤æ› â†’ åœæ­¢

---

## âœ… Min Heap å»ºç«‹å®Œæˆ

### æœ€çµ‚çµæœ

```
[1, 4, 3, 5, 10]
```

æ¨¹ç‹€åœ–ï¼š

```
        1
       / \
      4   3
     / \
    5  10
```

---

## å››ã€é‡é»å°ç…§

| é …ç›®         | Max Heap | Min Heap |
| ---------- | -------- | -------- |
| æ¯”è¼ƒæ–¹å¼       | æ‰¾æœ€å¤§      | æ‰¾æœ€å°      |
| heapify æ–¹å‘ | å¾€ä¸‹       | å¾€ä¸‹       |
| build èµ·é»   | n/2 âˆ’ 1  | n/2 âˆ’ 1  |
| æ™‚é–“è¤‡é›œåº¦      | O(n)     | O(n)     |

---

## äº”ã€è¶…é‡è¦ã€Œä¸€å¥è©±ç‰ˆæœ¬ã€

> **build_heap = å¾æœ€å¾Œä¸€å€‹éè‘‰ç¯€é»é–‹å§‹ï¼Œä¸€è·¯å¾€å‰åš heapify**

---

## å…­ã€è€ƒé»

â“ ç‚ºä»€éº¼ä¸æ˜¯ O(n log n)ï¼Ÿ

ç­”æ¡ˆï¼š

> å› ç‚ºåº•å±¤ç¯€é»å¾ˆå¤šä½†å¹¾ä¹ä¸å‹•ï¼Œä¸Šå±¤ç¯€é»å°‘ä½†æ‰æœƒå‹•å¾ˆå¤šï¼Œ
> **ç¸½æˆæœ¬åŠ èµ·ä¾†æ˜¯ O(n)**

---

# p.5 build heap è£œå……: indexè®Šå‹•è¦å¾‹

## æœ€æ ¸å¿ƒçš„ 3 æ¢ index è¦å¾‹ï¼ˆä¸€å®šè¦èƒŒï¼‰

ğŸ”¼ å¾€ä¸Šï¼ˆæ‰¾ i çš„ parentï¼‰ï¼š**parent(i) = (i - 1) / 2**     
ğŸ”½ å¾€å·¦ä¸‹ï¼ˆæ‰¾ i çš„ left childï¼‰ï¼š**left(i) = 2i + 1**    
ğŸ”½ å¾€å³ä¸‹ï¼ˆæ‰¾ i çš„ right childï¼‰ï¼š**right(i) = 2i + 2**    
ğŸ‘‰ æ•´å€‹ Heap çš„ index è·³å‹•ï¼Œåªé é€™ä¸‰æ¢   

---

å‡è¨­ï¼š
```
A = [4, 10, 3, 5, 1]
index: 0  1   2  3  4
```

## Max Heap çš„ index è·³å‹•

```
1 â†’ 0 â†’ 1 â†’ 3
```

## Min Heap çš„ index è·³å‹•

```
1 â†’ 4 â†’ 0 â†’ 1
```

## ä¸€ã€Max Heapï¼šç‚ºä»€éº¼æ˜¯ 1 â†’ 0 â†’ 1 â†’ 3ï¼Ÿ

### èƒŒæ™¯ï¼šæˆ‘å€‘åœ¨åšä»€éº¼ï¼Ÿ

åœ¨ **build_heapï¼ˆMax Heapï¼‰** æ™‚ï¼Œæˆ‘å€‘åšçš„æ˜¯ï¼š

```
i = 1
heapify(1)
i = 0
heapify(0)
```

---

## ğŸ”¹ ç¬¬ä¸€æ­¥ï¼š`i = 1`

```
heapify(1)
```

### index = 1

* value = 10
* children = index 3 (5), index 4 (1)

ğŸ‘‰ **ä¸ç”¨äº¤æ›**

### ğŸ‘‰ index åœåœ¨ 1

é€™å°±æ˜¯ç¬¬ä¸€å€‹ `1`

## ğŸ”¹ ç¬¬äºŒæ­¥ï¼š`i = 0`

```
heapify(0) 
```

### index = 0

* value = 4
* children = index 1 (10), index 2 (3)

### Max Heap è¦æ‰¾ã€Œæœ€å¤§ã€

* æœ€å¤§æ˜¯ **index 1**

âŒ é•å heap-order â†’ äº¤æ›

ğŸ‘‰ **index å¾ 0 è·³åˆ° 1 (å› index1ç‚ºæœ€å¤§)**

é€™å°±æ˜¯ï¼š

```
1 â†’ 0 â†’ 1
```

---

## ğŸ”¹ ç¬¬ä¸‰æ­¥ï¼šç¹¼çºŒ heapifyï¼ˆå› ç‚ºäº¤æ›äº†ï¼‰

ç¾åœ¨ array è®Šæˆï¼š

```
[10, 4, 3, 5, 1]
```

### ç¹¼çºŒ heapify(1)

* index = 1
* children = index 3 (5), index 4 (1)

Max Heap â†’ æ‰¾æœ€å¤§
â†’ index 3ï¼ˆ5ï¼‰

âŒ å†äº¤æ›

ğŸ‘‰ index å¾ **1 â†’ 3 (å› index3ç‚ºæœ€å¤§)**

---

## âœ… æ‰€ä»¥ Max Heap çš„å®Œæ•´è·³å‹•æ˜¯ï¼š

```
1        ï¼ˆheapify(1)ï¼Œæ²’å‹•ï¼‰
â†’ 0      ï¼ˆé–‹å§‹ heapify(0)ï¼‰
â†’ 1      ï¼ˆèˆ‡æœ€å¤§ child äº¤æ›ï¼‰
â†’ 3      ï¼ˆç¹¼çºŒå¾€ä¸‹ï¼‰
```

ğŸ“Œ **æ¯ä¸€æ¬¡å¾€ä¸‹ï¼Œéƒ½æ˜¯ã€Œè·³åˆ°æ¯”è¼ƒå¾Œè©²å»çš„ childã€**

---

## äºŒã€Min Heapï¼šç‚ºä»€éº¼æ˜¯ 1 â†’ 4 â†’ 0 â†’ 1ï¼Ÿ

ç¾åœ¨æˆ‘å€‘é‡æ–°ä¾†ï¼Œ**åŒä¸€å€‹åŸå§‹é™£åˆ—**ï¼š

```
[4, 10, 3, 5, 1]
```

---

## ğŸ”¹ ç¬¬ä¸€æ­¥ï¼š`i = 1`

```
heapify(1)
```

### index = 1

* value = 10
* children = index 3 (5), index 4 (1)

### Min Heap è¦å‰‡

* parent â‰¤ children
* è¦æ‰¾ **æœ€å°**

â†’ æœ€å°æ˜¯ **index 4**

âŒ é•å â†’ äº¤æ›

ğŸ‘‰ index å¾ **1 â†’ 4**

é€™å°±æ˜¯ï¼š

```
1 â†’ 4
```

---

## ğŸ”¹ index = 4

* æ˜¯è‘‰ç¯€é»
* æ²’ children

ğŸ‘‰ åœæ­¢

---

## ğŸ”¹ ç¬¬äºŒæ­¥ï¼š`i = 0`

```
heapify(0)
```

ç¾åœ¨é™£åˆ—æ˜¯ï¼š

```
[4, 1, 3, 5, 10]
```

### index = 0

* children = index 1 (1), index 2 (3)
* Min Heap â†’ æ‰¾æœ€å°

â†’ index 1

âŒ äº¤æ›

ğŸ‘‰ index å¾ **0 â†’ 1**

---

## ğŸ”¹ index = 1

* children = 3 (5), 4 (10)
* parent å·²æœ€å°

ğŸ‘‰ åœæ­¢

---

## âœ… æ‰€ä»¥ Min Heap çš„å®Œæ•´è·³å‹•æ˜¯ï¼š

```
1 â†’ 4    ï¼ˆç¬¬ä¸€æ¬¡ heapifyï¼‰
â†’ 0 â†’ 1  ï¼ˆç¬¬äºŒæ¬¡ heapifyï¼‰
```

---

## ä¸‰ã€ç‚ºä»€éº¼ Max / Min çš„ã€Œæ–¹å‘ä¸ä¸€æ¨£ã€ï¼Ÿ

## é—œéµä¸€å¥è©±ï¼ˆè«‹èƒŒï¼‰

> **heapify åªæœƒå¾€ã€Œè©²äº¤æ›çš„ childã€èµ°**

è€Œï¼š

| Heap é¡å‹  | è¦é¸çš„ child |
| -------- | --------- |
| Max Heap | è¼ƒå¤§çš„ child |
| Min Heap | è¼ƒå°çš„ child |

ğŸ‘‰ æ‰€ä»¥ï¼š

* Max Heapï¼šå¯èƒ½å¾€å·¦ã€ä¹Ÿå¯èƒ½å¾€å³
* Min Heapï¼šæ–¹å‘å®Œå…¨å¯èƒ½ä¸åŒ

---

## å››ã€è€ƒé»

> åœ¨ heapify éç¨‹ä¸­ï¼Œindex æœƒç§»å‹•åˆ°é•å heap-order çš„å­ç¯€é»ä½ç½®ï¼›
> Max Heap æœƒé¸è¼ƒå¤§çš„ childï¼ŒMin Heap æœƒé¸è¼ƒå°çš„ childï¼Œå› æ­¤å…©è€…çš„ index è·³å‹•è·¯å¾‘ä¸åŒã€‚

---

# p.6 Summary

---

## 1ï¸âƒ£ Data structure type

### **Binary Tree (Complete)**

### é€™ä¸€åˆ—åœ¨èªªä»€éº¼ï¼Ÿ

Heap æ˜¯ä¸€ç¨® **äºŒå…ƒæ¨¹ï¼ˆBinary Treeï¼‰**ï¼Œè€Œä¸”æ˜¯ **å®Œå…¨äºŒå…ƒæ¨¹ï¼ˆComplete Binary Treeï¼‰**ã€‚

### ä»€éº¼æ˜¯ Binary Treeï¼Ÿ

* æ¯å€‹ç¯€é» **æœ€å¤š 2 å€‹å°å­©**

  * left child
  * right child

### ä»€éº¼æ˜¯ Completeï¼Ÿ

* æ¯ä¸€å±¤ **ç›¡é‡å¡«æ»¿**
* æœ€åº•å±¤ **å¾å·¦åˆ°å³å¡«**

```
        O
       / \
      O   O
     / \  /
    O   O O
```

### ç‚ºä»€éº¼ä¸€å®šè¦ Completeï¼Ÿ

ğŸ‘‰ **ç‚ºäº†ç”¨é™£åˆ—å­˜**

å¦‚æœä¸æ˜¯ Completeï¼š

* é™£åˆ—æœƒæœ‰æ´
* index è¦å‰‡æœƒå£æ‰
* æ“ä½œæœƒè®Šæ…¢

### è€ƒè©¦ä¸€å¥è©±

> Heap æ˜¯ä¸€æ£µå®Œå…¨äºŒå…ƒæ¨¹

---

## 2ï¸âƒ£ Order property

### **Parent â‰¥ Childrenï¼ˆMaxï¼‰ / â‰¤ Childrenï¼ˆMinï¼‰**

### é€™ä¸€åˆ—åœ¨èªªä»€éº¼ï¼Ÿ

Heap æœ‰ã€Œå¤§å°è¦å‰‡ã€ï¼Œä½†åªç®¡ **çˆ¶å­ä¹‹é–“**ã€‚

### Max Heap

```
parent â‰¥ left child
parent â‰¥ right child
```

ğŸ‘‰ æœ€å¤§å€¼ä¸€å®šåœ¨ root

### Min Heap

```
parent â‰¤ left child
parent â‰¤ right child
```

ğŸ‘‰ æœ€å°å€¼ä¸€å®šåœ¨ root

### æ–°æ‰‹æœ€å¸¸èª¤æœƒ

âŒ Heap ä¸æ˜¯ã€Œå…¨éƒ¨æ’åºå¥½ã€
âœ… åªä¿è­‰ **root æœ€é‡è¦**

### è€ƒè©¦ä¸€å¥è©±

> Heap åªä¿è­‰çˆ¶å­é †åºï¼Œä¸ä¿è­‰å…„å¼Ÿé †åº

---

## 3ï¸âƒ£ Stored in

### **Array (most efficient)**

### é€™ä¸€åˆ—åœ¨èªªä»€éº¼ï¼Ÿ

Heap **å¹¾ä¹ä¸€å®šç”¨é™£åˆ—å¯¦ä½œ**ï¼Œä¸æ˜¯ç”¨æŒ‡æ¨™æ¨¹ã€‚

### ç‚ºä»€éº¼é™£åˆ—é€™éº¼å¥½ï¼Ÿ

å› ç‚º Complete Binary Tree æœ‰å›ºå®š index è¦å¾‹ï¼š

| é—œä¿‚          | å…¬å¼          |
| ----------- | ----------- |
| parent      | (i âˆ’ 1) / 2 |
| left child  | 2i + 1      |
| right child | 2i + 2      |

### å¥½è™•

* ä¸ç”¨æŒ‡æ¨™
* è¨˜æ†¶é«”é€£çºŒ
* Cache-friendly
* æ“ä½œå¿«

### è€ƒè©¦ä¸€å¥è©±

> Heap æœ€æœ‰æ•ˆç‡çš„å¯¦ä½œæ–¹å¼æ˜¯é™£åˆ—

---

## 4ï¸âƒ£ Typical uses

### **Priority Queue, Scheduling, Heapsort**

### é€™ä¸€åˆ—åœ¨èªªä»€éº¼ï¼Ÿ

Heap æ˜¯ç‚ºäº†è§£æ±ºã€Œ**èª°å…ˆè™•ç†**ã€çš„å•é¡Œã€‚

### Priority Queueï¼ˆæœ€é‡è¦ï¼‰

* æ¯å€‹å…ƒç´ æœ‰ priority
* æ°¸é å…ˆå–æœ€é«˜ï¼ˆæˆ–æœ€ä½ï¼‰

ğŸ“Œ å¹¾ä¹æ‰€æœ‰ Priority Queue éƒ½ç”¨ Heap

### Schedulingï¼ˆæ’ç¨‹ï¼‰

* CPU å·¥ä½œæ’ç¨‹
* å°è¡¨æ©Ÿä½‡åˆ—
* ä½œæ¥­ç³»çµ±

ğŸ‘‰ èª°æœ€æ€¥ã€èª°æœ€é‡è¦å…ˆåš

### Heapsort

* åˆ©ç”¨ Heap çš„ã€Œroot æ˜¯æœ€å¤§/æœ€å°ã€
* ä¸éœ€è¦é¡å¤–ç©ºé–“
* æ™‚é–“ç©©å®š O(n log n)

### è€ƒè©¦ä¸€å¥è©±

> Heap å¸¸ç”¨ä¾†å¯¦ä½œ Priority Queue

---

## 5ï¸âƒ£ Performance

### **Logarithmic insertion / removal**

### é€™ä¸€åˆ—åœ¨èªªä»€éº¼ï¼Ÿ

Heap çš„æ’å…¥ã€åˆªé™¤éƒ½å¾ˆå¿«ã€‚

### ç‚ºä»€éº¼æ˜¯ log nï¼Ÿ

å› ç‚ºï¼š

* Heap æ˜¯å®Œå…¨äºŒå…ƒæ¨¹
* é«˜åº¦ = log n
* äº¤æ›åªæœƒæ²¿ä¸€æ¢è·¯

### æ“ä½œæ™‚é–“ç¸½æ•´ç†

| æ“ä½œ         | æ™‚é–“       |
| ---------- | -------- |
| insert     | O(log n) |
| extract    | O(log n) |
| peek       | O(1)     |
| build_heap | O(n)     |

### è€ƒè©¦ä¸€å¥è©±

> Heap çš„æ•ˆç‡ä¾†è‡ªæ–¼æ¨¹é«˜æ˜¯ log n

## ğŸ”¥ å…¨è¡¨ã€Œç™½è©±ç¸½çµç‰ˆã€

> Heap æ˜¯ä¸€ç¨®ç”¨é™£åˆ—å­˜çš„å®Œå…¨äºŒå…ƒæ¨¹ï¼Œ
> åªä¿è­‰çˆ¶å­é †åºï¼Œå› æ­¤å¯ä»¥åœ¨ O(log n) æ™‚é–“å…§å¿«é€Ÿæ’å…¥èˆ‡åˆªé™¤ï¼Œ
> éå¸¸é©åˆç”¨ä¾†å¯¦ä½œ Priority Queueã€‚

## ğŸ¯ è€ƒé»

**Qï¼šç‚ºä»€éº¼ Heap é©åˆ Priority Queueï¼Ÿ**

> å› ç‚º Heap ä¿è­‰ root æ˜¯æœ€å¤§æˆ–æœ€å°å€¼ï¼Œä¸”æ’å…¥èˆ‡åˆªé™¤çš„æ™‚é–“è¤‡é›œåº¦ç‚º O(log n)ã€‚

---

# p.7 Why Order Means Priority in a Heap 

---

### ä»€éº¼æ˜¯ Priorityï¼Ÿ

> **Priority = é‡è¦æ€§æˆ–ç·Šæ€¥ç¨‹åº¦**

åœ¨ **Priority Queue** ä¸­ï¼š

* æ¯å€‹å…ƒç´ éƒ½æœ‰ä¸€å€‹ **priority value**
* **å…ˆè™•ç† priority è¼ƒé«˜çš„å…ƒç´ **

  * æ•¸å€¼å¯èƒ½æ˜¯ã€Œå¤§ä»£è¡¨é«˜ã€
  * æˆ–ã€Œå°ä»£è¡¨é«˜ã€ï¼ˆä¾å®šç¾©ï¼‰

### Priority çš„å¯¦éš›æ„ç¾©ï¼ˆä¾‹å­ï¼‰

| æƒ…å¢ƒ                   | Priority åˆ¤æ–·                        |
| -------------------- | ---------------------------------- |
| æ€¥è¨ºç—…äººï¼ˆtriage level 5ï¼‰ | **é«˜ priorityï¼ˆæœ€ç·Šæ€¥ï¼‰**                |
| ä½œæ¥­ç³»çµ±è¡Œç¨‹ï¼ˆå‰©é¤˜æ™‚é–“æœ€çŸ­ï¼‰       | **é«˜ priorityï¼ˆShortest Job Firstï¼‰** |
| ç¶²è·¯å°åŒ…ï¼ˆé«˜ QoSï¼‰          | **é«˜ priorityï¼ˆå…ˆå‚³é€ï¼‰**                |

### èˆ‡ Heap çš„é—œä¿‚ï¼ˆä¸€å®šæœƒè€ƒï¼‰

* **Heap ç”¨æ•¸å€¼å¤§å°ä»£è¡¨ priority**
* **Root = æœ€é«˜ priority**

  * Max Heapï¼šæ•¸å€¼å¤§ â†’ priority é«˜
  * Min Heapï¼šæ•¸å€¼å° â†’ priority é«˜

### ä¸€å¥è©±è€ƒè©¦ç­”æ¡ˆï¼ˆå¿…èƒŒï¼‰

> Priority Queue æ˜¯ä¸€ç¨®æ¯æ¬¡éƒ½å…ˆå–å‡ºã€Œæœ€é«˜å„ªå…ˆæ¬Šã€å…ƒç´ çš„è³‡æ–™çµæ§‹ã€‚

### çµè«–
> **Priority = å…ˆåšèª°**
> Heap æ˜¯ Priority Queue çš„å¸¸è¦‹å¯¦ä½œæ–¹å¼

### å¯¦éš›ä¾‹å­

| æƒ…å¢ƒ                           | Priority å®šç¾©        | ä½¿ç”¨ Heap      |
| ---------------------------- | ------------------ | ------------ |
| æ€¥è¨ºå®¤ç—…äººï¼ˆtriage åˆ†ç´šï¼Œæ•¸å­—è¶Šå¤§è¶Šç·Šæ€¥ï¼‰     | æ•¸å­—å¤§ â†’ å…ˆè™•ç†          | **Max Heap** |
| æ€¥è¨ºå®¤ç—…äººï¼ˆtriage åˆ†ç´šï¼Œæ•¸å­—è¶Šå°è¶Šç·Šæ€¥ï¼‰     | æ•¸å­—å° â†’ å…ˆè™•ç†          | **Min Heap** |
| ä½œæ¥­ç³»çµ±è¡Œç¨‹æ’ç¨‹ï¼ˆShortest Job Firstï¼‰ | å‰©é¤˜æ™‚é–“çŸ­ â†’ é«˜ priority | **Min Heap** |
| ä½œæ¥­ç³»çµ±è¡Œç¨‹æ’ç¨‹ï¼ˆå„ªå…ˆæ¬Šæ•¸å€¼è¶Šå¤§è¶Šé‡è¦ï¼‰         | priority å¤§ â†’ å…ˆåŸ·è¡Œ   | **Max Heap** |
| å°è¡¨æ©Ÿå·¥ä½œæ’ç¨‹                      | æ–‡ä»¶å¤§å°å° â†’ å…ˆå°         | **Min Heap** |
| éŠæˆ²æ’è¡Œæ¦œ                        | åˆ†æ•¸é«˜ â†’ æ’å‰é¢          | **Max Heap** |
| ç¶²è·¯å°åŒ…å‚³é€ï¼ˆQoS è¶Šé«˜è¶Šé‡è¦ï¼‰            | QoS å¤§ â†’ å…ˆé€         | **Max Heap** |
| é†«é™¢æ›è™Ÿå«è™Ÿï¼ˆè™Ÿç¢¼å°å…ˆçœ‹ï¼‰                | è™Ÿç¢¼å° â†’ å…ˆè™•ç†          | **Min Heap** |
| CPU å³æ™‚ä»»å‹™ï¼ˆdeadline æœ€æ—©ï¼‰        | æˆªæ­¢æ™‚é–“æ—© â†’ å…ˆè™•ç†        | **Min Heap** |
| äº‹ä»¶æ¨¡æ“¬ï¼ˆæœ€æ—©ç™¼ç”Ÿçš„äº‹ä»¶ï¼‰                | æ™‚é–“æ—© â†’ å…ˆç™¼ç”Ÿ          | **Min Heap** |
| é£›æ©Ÿé™è½æ’ç¨‹     | ç‡ƒæ–™è¶Šå°‘è¶Šç·Šæ€¥     | **Min Heap** |
| é£›æ©Ÿé™è½æ’ç¨‹     | ç·Šæ€¥ç­‰ç´šè¶Šé«˜      | **Max Heap** |
| é†«é™¢æ‰‹è¡“å®¤æ’ç¨‹    | ç­‰å¾…æ™‚é–“æœ€ä¹…å…ˆ     | **Max Heap** |
| é†«é™¢æ‰‹è¡“å®¤æ’ç¨‹    | ç—…æƒ…æœ€åš´é‡å…ˆ      | **Max Heap** |
| å®¢æœå·¥å–®ç³»çµ±     | å®¢æˆ¶ç­‰ç´šè¶Šé«˜      | **Max Heap** |
| å®¢æœå·¥å–®ç³»çµ±     | å·¥å–®å»ºç«‹æ™‚é–“è¶Šæ—©    | **Min Heap** |
| ç¶²ç«™è«‹æ±‚æ’ç¨‹     | è«‹æ±‚è™•ç†æ™‚é–“æœ€çŸ­    | **Min Heap** |
| é›»æ¢¯æ§åˆ¶ç³»çµ±     | æœ€è¿‘æ¨“å±¤å…ˆæœå‹™     | **Min Heap** |
| ç‰©æµé…é€ç³»çµ±     | æˆªæ­¢æ™‚é–“æœ€æ—©      | **Min Heap** |
| ç‰©æµé…é€ç³»çµ±     | è²¨ç‰©åƒ¹å€¼æœ€é«˜      | **Max Heap** |
| è‚¡ç¥¨äº¤æ˜“æ’®åˆï¼ˆè²·å–®ï¼‰ | å‡ºåƒ¹æœ€é«˜        | **Max Heap** |
| è‚¡ç¥¨äº¤æ˜“æ’®åˆï¼ˆè³£å–®ï¼‰ | å”®åƒ¹æœ€ä½        | **Min Heap** |
| éŠæˆ²ä»»å‹™ç³»çµ±     | ä»»å‹™çå‹µæœ€é«˜      | **Max Heap** |
| éŠæˆ²ä»»å‹™ç³»çµ±     | å‰©é¤˜æ™‚é–“æœ€å°‘      | **Min Heap** |
| éŸ³æ¨‚æ’­æ”¾æ¸…å–®     | ä½¿ç”¨è€…å–œå¥½åˆ†æ•¸æœ€é«˜   | **Max Heap** |
| æœå°‹å¼•æ“çµæœæ’åº   | ç›¸é—œåº¦æœ€é«˜       | **Max Heap** |
| åƒåœ¾å›æ”¶æ’ç¨‹     | æœ€ä¹…æœªä½¿ç”¨ç‰©ä»¶     | **Max Heap** |
| äº‹ä»¶æ¨¡æ“¬ç³»çµ±     | ç™¼ç”Ÿæ™‚é–“æœ€æ—©      | **Min Heap** |

---

# p.9 å°çµ

* Heap æ˜¯ç”¨ä¾†å¿«é€Ÿæ‰¾åˆ°æœ€å¤§æˆ–æœ€å°å€¼çš„æ¨¹ç‹€è³‡æ–™çµæ§‹
* æ¯å€‹çˆ¶ç¯€é»è·Ÿå­ç¯€é»æœ‰é †åºæ€§ï¼ˆorder propertyï¼‰
* æ¯å€‹ç¯€é»æœ‰ã€Œé—œéµå€¼ã€æ±ºå®šå„ªå…ˆæ¬Š
* æ ¹ç¯€é»æ°¸é æ˜¯æœ€é«˜å„ªå…ˆç´š
* æ’å…¥ã€åˆªé™¤ã€å»º Heap éƒ½å¾ˆå¿«ï¼ˆO(log n)ï¼‰

---

# p.20 Time Complexity

# ä¸€ã€é€æ¢æ•™ä½ ï¼ˆç™½è©±ç‰ˆï¼‰

## 1ï¸âƒ£ `peek-max / peek-min` â€” O(1)

### åœ¨åšä»€éº¼ï¼Ÿ

* åªã€Œçœ‹ã€æœ€å¤§æˆ–æœ€å°å€¼
* ä¸åˆªã€ä¸äº¤æ›

### ç‚ºä»€éº¼æ˜¯ O(1)ï¼Ÿ

* Heap çš„æœ€é«˜ priority æ°¸é åœ¨ **root**
* root å›ºå®šåœ¨ **index 0**

ğŸ‘‰ ä¸ç”¨èµ°æ¨¹ã€ä¸ç”¨æ¯”

## 2ï¸âƒ£ `insert`ï¼ˆsift-upï¼‰â€” O(log n)

### åœ¨åšä»€éº¼ï¼Ÿ

* æ–°å…ƒç´ æ”¾é€² Heap
* ä¿® Heap-order

### æ€éº¼ä¿®ï¼Ÿ

* æ–°ç¯€é»å…ˆæ”¾åœ¨ **æœ€å¾Œï¼ˆleafï¼‰**
* ä¸€è·¯è·Ÿ parent æ¯”
* å¿…è¦æ™‚äº¤æ›ï¼ˆsift-upï¼‰

### ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* æœ€å¤šèµ°åˆ° root
* Heap é«˜åº¦ = log n

## 3ï¸âƒ£ `extract-max / extract-min`ï¼ˆsift-downï¼‰â€” O(log n)

### åœ¨åšä»€éº¼ï¼Ÿ

* ç§»é™¤æœ€é«˜ priority çš„å…ƒç´ ï¼ˆrootï¼‰

### æ€éº¼ä¿®ï¼Ÿ

* ç”¨æœ€å¾Œä¸€å€‹ç¯€é»è£œ root
* ä¸€è·¯å¾€ä¸‹è·Ÿ child æ¯”ï¼ˆsift-downï¼‰

### ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* æœ€å¤šèµ°åˆ° leaf
* åªèµ°ä¸€æ¢è·¯

## 4ï¸âƒ£ `increase-key`ï¼ˆMax Heapï¼‰â€” O(log n)

### åœ¨åšä»€éº¼ï¼Ÿ

* æŸå€‹å…ƒç´ çš„ key **è®Šå¤§**
* å¯èƒ½æ¯” parent é‚„å¤§

### æ€éº¼ä¿®ï¼Ÿ

* **sift-up**
* è·Ÿ parent æ¯”ï¼Œå¿…è¦æ™‚å¾€ä¸Šæ›

### ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* æœ€å¤šå¾€ä¸Šèµ°åˆ° root

---

## 5ï¸âƒ£ `decrease-key`ï¼ˆMax Heapï¼‰â€” O(log n)

### åœ¨åšä»€éº¼ï¼Ÿ

* æŸå€‹å…ƒç´ çš„ key **è®Šå°**
* å¯èƒ½æ¯” child é‚„å°

### æ€éº¼ä¿®ï¼Ÿ

* **sift-down**
* è·Ÿ child æ¯”ï¼Œå¿…è¦æ™‚å¾€ä¸‹æ›

### ç‚ºä»€éº¼æ˜¯ O(log n)ï¼Ÿ

* æœ€å¤šå¾€ä¸‹èµ°åˆ° leaf

---

> ğŸ” **Min Heap å®Œå…¨å°ç¨±**
>
> * decrease-key â†’ sift-up
> * increase-key â†’ sift-down

---

## 6ï¸âƒ£ `build-heap`ï¼ˆbottom-up heapifyï¼‰â€” O(n)

### åœ¨åšä»€éº¼ï¼Ÿ

* æŠŠã€Œäº‚æ‰çš„é™£åˆ—ã€ä¸€æ¬¡è®Šæˆ Heap

### é—œéµæ–¹æ³•

* **Floydâ€™s algorithm**
* å¾ `n/2 âˆ’ 1` â†’ `0`
* ä¸€è·¯åš `heapify`

### ç‚ºä»€éº¼æ˜¯ O(n)ï¼Ÿ

* åº•å±¤ç¯€é»å¤šï¼Œä½†å¹¾ä¹ä¸ç”¨å‹• (å¤§å¤šæ•¸ç¯€é»éƒ½åœ¨åº•å±¤)
* åªæœ‰å°‘æ•¸ä¸Šå±¤ç¯€é»æœƒå‹•å¾ˆå¤š
* ç¸½æˆæœ¬ = O(n)

ğŸ‘‰ æ¯” n æ¬¡ insertï¼ˆO(n log n)ï¼‰å¿«

### è£œå……

**Bottom-up Heapifyï¼ˆå¿…èƒŒï¼‰**    
*  å¾ n/2 âˆ’ 1 é–‹å§‹
*  ä¸€è·¯åšåˆ° index 0
*  æ¯æ¬¡ç”¨ sift-down
*  å»º Heap çš„æ™‚é–“æ˜¯ O(n)

---

## 7ï¸âƒ£ `heapsort` â€” O(n log n)

### åœ¨åšä»€éº¼ï¼Ÿ

* ç”¨ Heap ä¾†æ’åº
* **Heap æ˜¯ä¸€æ£µå®Œå…¨äºŒå…ƒæ¨¹**ï¼Œé«˜åº¦å¤§ç´„æ˜¯ **log n**ã€‚
* Heapsort ä¸»è¦åœ¨åšä¸€ä»¶äº‹ï¼š**æŠŠæœ€å¤§å€¼ä¸Ÿåˆ°æœ€å¾Œé¢**ï¼Œç„¶å¾ŒæŠŠå †ä¿®å¥½ã€‚

### æ€éº¼åšï¼Ÿ

1. å…ˆæŠŠè³‡æ–™è®Šæˆ heapï¼Œbuild-heap â†’ O(n)ï¼ˆé€™æ­¥å¤§ç´„ **O(n)**ï¼Œä¸å½±éŸ¿æœ€å¾Œçµæœï¼‰
2. æ¥è‘—åš **n æ¬¡** extract-max / minï¼Œæ¯æ¬¡ O(log n)ï¼š

   * å–å‡ºæœ€å¤§å€¼ï¼ˆæ ¹ï¼‰æ”¾åˆ°å°¾ç«¯
   * ç„¶å¾Œã€Œå¾€ä¸‹èª¿æ•´ã€è®“å®ƒé‡æ–°è®Šæˆ heap
   * é€™å€‹ã€Œå¾€ä¸‹èª¿æ•´ã€æœ€å¤šèµ°æ¨¹é«˜ï¼Œæ‰€ä»¥æ˜¯ **O(log n)**

### ç¸½æ™‚é–“

```
O(n) + n Ã— O(log n) = O(n log n)
```

### è£œå……

åœ¨ **heapsortï¼ˆç”¨é™£åˆ—åš max-heapï¼‰** çš„æ’åºéšæ®µï¼Œé€šå¸¸æ˜¯**å¾€ä¸‹èª¿æ•´**ï¼ˆsift-down / heapify-downï¼‰ï¼Œä¸æ˜¯å¾€ä¸Šã€‚

ç‚ºä»€éº¼æ˜¯å¾€ä¸‹ï¼Ÿ

* ä½ æŠŠã€Œæ ¹(æœ€å¤§å€¼)ã€è·Ÿã€Œæœ€å¾Œä¸€å€‹å…ƒç´ ã€äº¤æ›å¾Œ
  **æ–°çš„æ ¹** å¯èƒ½è®Šå°ã€é•å max-heapï¼ˆæ ¹è¦æœ€å¤§ï¼‰
* é€™æ™‚å€™è¦æŠŠå®ƒä¸€è·¯è·Ÿã€Œè¼ƒå¤§çš„å­ç¯€é»ã€äº¤æ›ï¼Œè®“å®ƒä¸‹æ²‰å›æ­£ç¢ºä½ç½®
  â†’ é€™å°±æ˜¯ **å¾€ä¸‹èª¿æ•´**

ä»€éº¼æ™‚å€™æ˜¯å¾€ä¸Šèª¿æ•´ï¼Ÿ

* ä½ åœ¨ **æ’å…¥ä¸€å€‹æ–°å…ƒç´ ** åˆ° heap å°¾ç«¯æ™‚ï¼ˆpriority queue å¸¸è¦‹ï¼‰
  æ–°å…ƒç´ å¯èƒ½æ¯”çˆ¶ç¯€é»å¤§ï¼Œå°±è¦ä¸€è·¯å¾€ä¸Šæµ®
  â†’ é€™æ‰æ˜¯ **å¾€ä¸Šèª¿æ•´ï¼ˆsift-upï¼‰**

æ‰€ä»¥ï¼š

* **å»ºå †ï¼ˆè‡ªåº•å‘ä¸Šå»ºå †ï¼‰**ï¼šæ¯å€‹ç¯€é»åšçš„æ˜¯ã€Œå¾€ä¸‹èª¿æ•´ã€
* **æ’åºéšæ®µæ¯æ¬¡äº¤æ›æ ¹èˆ‡å°¾**ï¼šä¹Ÿæ˜¯ã€Œå¾€ä¸‹èª¿æ•´ã€

çµè«–ï¼šheapsort å…¸å‹ç‰ˆæœ¬é çš„æ˜¯ **down-heap**ï¼Œä¸æ˜¯ up-heapã€‚

---

# äºŒã€è€ƒå‰ã€Œè¶…ç²¾ç°¡ç­†è¨˜ç‰ˆã€ï¼ˆç›´æ¥èƒŒï¼‰

## Heap Operations â€” è€ƒå‰é€Ÿè¨˜

* **peek**ï¼šO(1)
  â†’ root åœ¨ index 0

* **insert**ï¼šO(log n)
  â†’ leaf â†’ rootï¼ˆsift-upï¼‰

* **extract**ï¼šO(log n)
  â†’ root â†’ leafï¼ˆsift-downï¼‰

* **increase-keyï¼ˆMaxï¼‰**ï¼šO(log n)
  â†’ sift-up

* **decrease-keyï¼ˆMaxï¼‰**ï¼šO(log n)
  â†’ sift-down

* **build-heap**ï¼šO(n)
  â†’ bottom-up heapifyï¼ˆFloydï¼‰

* **heapsort**ï¼šO(n log n)
  â†’ n æ¬¡ extract

---

## ç¸½çµ

> Heap çš„æ“ä½œæ™‚é–“å–æ±ºæ–¼æ¨¹é«˜ï¼ˆlog nï¼‰ï¼Œ
> build-heap æ˜¯ä¾‹å¤–ï¼Œå› ç‚ºä½¿ç”¨ bottom-up heapifyã€‚

---
